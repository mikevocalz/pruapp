{"ast":null,"code":"\"use strict\";exports.__esModule=true;exports[\"default\"]=initializeBuildWatcher;var _eventsource=require(\"./error-overlay/eventsource\");function initializeBuildWatcher(toggleCallback){var shadowHost=document.createElement('div');shadowHost.id='__next-build-watcher';shadowHost.style.position='fixed';shadowHost.style.bottom='10px';shadowHost.style.right='20px';shadowHost.style.width=0;shadowHost.style.height=0;shadowHost.style.zIndex=99999;document.body.appendChild(shadowHost);var shadowRoot;var prefix='';if(shadowHost.attachShadow){shadowRoot=shadowHost.attachShadow({mode:'open'});}else{shadowRoot=shadowHost;prefix='__next-build-watcher-';}var container=createContainer(prefix);shadowRoot.appendChild(container);var css=createCss(prefix);shadowRoot.appendChild(css);var isVisible=false;var isBuilding=false;var timeoutId=null;var evtSource=(0,_eventsource.getEventSourceWrapper)({path:'/_next/webpack-hmr'});evtSource.addMessageListener(function(event){if(event.data===\"\\uD83D\\uDC93\"){return;}try{handleMessage(event);}catch(_unused){}});function handleMessage(event){var obj=typeof event==='string'?{action:event}:JSON.parse(event.data);switch(obj.action){case'building':timeoutId&&clearTimeout(timeoutId);isVisible=true;isBuilding=true;updateContainer();break;case'built':case'sync':isBuilding=false;timeoutId=setTimeout(function(){isVisible=false;updateContainer();},100);updateContainer();break;}}toggleCallback(handleMessage);function updateContainer(){if(isBuilding){container.classList.add(\"\".concat(prefix,\"building\"));}else{container.classList.remove(\"\".concat(prefix,\"building\"));}if(isVisible){container.classList.add(\"\".concat(prefix,\"visible\"));}else{container.classList.remove(\"\".concat(prefix,\"visible\"));}}}function createContainer(prefix){var container=document.createElement('div');container.id=\"\".concat(prefix,\"container\");container.innerHTML=\"\\n    <div id=\\\"\".concat(prefix,\"icon-wrapper\\\">\\n      <svg viewBox=\\\"0 0 226 200\\\">\\n        <defs>\\n          <linearGradient\\n            x1=\\\"114.720775%\\\"\\n            y1=\\\"181.283245%\\\"\\n            x2=\\\"39.5399306%\\\"\\n            y2=\\\"100%\\\"\\n            id=\\\"\").concat(prefix,\"linear-gradient\\\"\\n          >\\n            <stop stop-color=\\\"#000000\\\" offset=\\\"0%\\\" />\\n            <stop stop-color=\\\"#FFFFFF\\\" offset=\\\"100%\\\" />\\n          </linearGradient>\\n        </defs>\\n        <g id=\\\"\").concat(prefix,\"icon-group\\\" fill=\\\"none\\\" stroke=\\\"url(#\").concat(prefix,\"linear-gradient)\\\" stroke-width=\\\"18\\\">\\n          <path d=\\\"M113,5.08219117 L4.28393801,197.5 L221.716062,197.5 L113,5.08219117 Z\\\" />\\n        </g>\\n      </svg>\\n    </div>\\n  \");return container;}function createCss(prefix){var css=document.createElement('style');css.textContent=\"\\n    #\".concat(prefix,\"container {\\n      position: absolute;\\n      bottom: 10px;\\n      right: 30px;\\n\\n      border-radius: 3px;\\n      background: #000;\\n      color: #fff;\\n      font: initial;\\n      cursor: initial;\\n      letter-spacing: initial;\\n      text-shadow: initial;\\n      text-transform: initial;\\n      visibility: initial;\\n\\n      padding: 7px 10px 8px 10px;\\n      align-items: center;\\n      box-shadow: 0 11px 40px 0 rgba(0, 0, 0, 0.25), 0 2px 10px 0 rgba(0, 0, 0, 0.12);\\n\\n      display: none;\\n      opacity: 0;\\n      transition: opacity 0.1s ease, bottom 0.1s ease;\\n      animation: \").concat(prefix,\"fade-in 0.1s ease-in-out;\\n    }\\n\\n    #\").concat(prefix,\"container.\").concat(prefix,\"visible {\\n      display: flex;\\n    }\\n\\n    #\").concat(prefix,\"container.\").concat(prefix,\"building {\\n      bottom: 20px;\\n      opacity: 1;\\n    }\\n\\n    #\").concat(prefix,\"icon-wrapper {\\n      width: 16px;\\n      height: 16px;\\n    }\\n\\n    #\").concat(prefix,\"icon-wrapper > svg {\\n      width: 100%;\\n      height: 100%;\\n    }\\n\\n    #\").concat(prefix,\"icon-group {\\n      animation: \").concat(prefix,\"strokedash 1s ease-in-out both infinite;\\n    }\\n\\n    @keyframes \").concat(prefix,\"fade-in {\\n      from {\\n        bottom: 10px;\\n        opacity: 0;\\n      }\\n      to {\\n        bottom: 20px;\\n        opacity: 1;\\n      }\\n    }\\n\\n    @keyframes \").concat(prefix,\"strokedash {\\n      0% {\\n        stroke-dasharray: 0 226;\\n      }\\n      80%,\\n      100% {\\n        stroke-dasharray: 659 226;\\n      }\\n    }\\n  \");return css;}","map":{"version":3,"sources":["../../../client/dev/dev-build-watcher.js"],"names":["shadowHost","document","prefix","shadowRoot","mode","container","createContainer","css","createCss","isVisible","isBuilding","timeoutId","evtSource","path","event","handleMessage","obj","action","JSON","clearTimeout","updateContainer","setTimeout","toggleCallback"],"mappings":"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","sourcesContent":["import { getEventSourceWrapper } from './error-overlay/eventsource'\n\nexport default function initializeBuildWatcher(toggleCallback) {\n  const shadowHost = document.createElement('div')\n  shadowHost.id = '__next-build-watcher'\n  // Make sure container is fixed and on a high zIndex so it shows\n  shadowHost.style.position = 'fixed'\n  shadowHost.style.bottom = '10px'\n  shadowHost.style.right = '20px'\n  shadowHost.style.width = 0\n  shadowHost.style.height = 0\n  shadowHost.style.zIndex = 99999\n  document.body.appendChild(shadowHost)\n\n  let shadowRoot\n  let prefix = ''\n\n  if (shadowHost.attachShadow) {\n    shadowRoot = shadowHost.attachShadow({ mode: 'open' })\n  } else {\n    // If attachShadow is undefined then the browser does not support\n    // the Shadow DOM, we need to prefix all the names so there\n    // will be no conflicts\n    shadowRoot = shadowHost\n    prefix = '__next-build-watcher-'\n  }\n\n  // Container\n  const container = createContainer(prefix)\n  shadowRoot.appendChild(container)\n\n  // CSS\n  const css = createCss(prefix)\n  shadowRoot.appendChild(css)\n\n  // State\n  let isVisible = false\n  let isBuilding = false\n  let timeoutId = null\n\n  // Handle events\n  const evtSource = getEventSourceWrapper({ path: '/_next/webpack-hmr' })\n  evtSource.addMessageListener((event) => {\n    // This is the heartbeat event\n    if (event.data === '\\uD83D\\uDC93') {\n      return\n    }\n\n    try {\n      handleMessage(event)\n    } catch {}\n  })\n\n  function handleMessage(event) {\n    const obj =\n      typeof event === 'string' ? { action: event } : JSON.parse(event.data)\n\n    // eslint-disable-next-line default-case\n    switch (obj.action) {\n      case 'building':\n        timeoutId && clearTimeout(timeoutId)\n        isVisible = true\n        isBuilding = true\n        updateContainer()\n        break\n      case 'built':\n      case 'sync':\n        isBuilding = false\n        // Wait for the fade out transtion to complete\n        timeoutId = setTimeout(() => {\n          isVisible = false\n          updateContainer()\n        }, 100)\n        updateContainer()\n        break\n    }\n  }\n\n  toggleCallback(handleMessage)\n\n  function updateContainer() {\n    if (isBuilding) {\n      container.classList.add(`${prefix}building`)\n    } else {\n      container.classList.remove(`${prefix}building`)\n    }\n\n    if (isVisible) {\n      container.classList.add(`${prefix}visible`)\n    } else {\n      container.classList.remove(`${prefix}visible`)\n    }\n  }\n}\n\nfunction createContainer(prefix) {\n  const container = document.createElement('div')\n  container.id = `${prefix}container`\n  container.innerHTML = `\n    <div id=\"${prefix}icon-wrapper\">\n      <svg viewBox=\"0 0 226 200\">\n        <defs>\n          <linearGradient\n            x1=\"114.720775%\"\n            y1=\"181.283245%\"\n            x2=\"39.5399306%\"\n            y2=\"100%\"\n            id=\"${prefix}linear-gradient\"\n          >\n            <stop stop-color=\"#000000\" offset=\"0%\" />\n            <stop stop-color=\"#FFFFFF\" offset=\"100%\" />\n          </linearGradient>\n        </defs>\n        <g id=\"${prefix}icon-group\" fill=\"none\" stroke=\"url(#${prefix}linear-gradient)\" stroke-width=\"18\">\n          <path d=\"M113,5.08219117 L4.28393801,197.5 L221.716062,197.5 L113,5.08219117 Z\" />\n        </g>\n      </svg>\n    </div>\n  `\n\n  return container\n}\n\nfunction createCss(prefix) {\n  const css = document.createElement('style')\n  css.textContent = `\n    #${prefix}container {\n      position: absolute;\n      bottom: 10px;\n      right: 30px;\n\n      border-radius: 3px;\n      background: #000;\n      color: #fff;\n      font: initial;\n      cursor: initial;\n      letter-spacing: initial;\n      text-shadow: initial;\n      text-transform: initial;\n      visibility: initial;\n\n      padding: 7px 10px 8px 10px;\n      align-items: center;\n      box-shadow: 0 11px 40px 0 rgba(0, 0, 0, 0.25), 0 2px 10px 0 rgba(0, 0, 0, 0.12);\n\n      display: none;\n      opacity: 0;\n      transition: opacity 0.1s ease, bottom 0.1s ease;\n      animation: ${prefix}fade-in 0.1s ease-in-out;\n    }\n\n    #${prefix}container.${prefix}visible {\n      display: flex;\n    }\n\n    #${prefix}container.${prefix}building {\n      bottom: 20px;\n      opacity: 1;\n    }\n\n    #${prefix}icon-wrapper {\n      width: 16px;\n      height: 16px;\n    }\n\n    #${prefix}icon-wrapper > svg {\n      width: 100%;\n      height: 100%;\n    }\n\n    #${prefix}icon-group {\n      animation: ${prefix}strokedash 1s ease-in-out both infinite;\n    }\n\n    @keyframes ${prefix}fade-in {\n      from {\n        bottom: 10px;\n        opacity: 0;\n      }\n      to {\n        bottom: 20px;\n        opacity: 1;\n      }\n    }\n\n    @keyframes ${prefix}strokedash {\n      0% {\n        stroke-dasharray: 0 226;\n      }\n      80%,\n      100% {\n        stroke-dasharray: 659 226;\n      }\n    }\n  `\n\n  return css\n}\n"]},"metadata":{},"sourceType":"script"}